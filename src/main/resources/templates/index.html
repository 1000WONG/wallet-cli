<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>tron block chain explorer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <script src="/static/js/jquery.js"></script>
  <script src="/static/cryptohash/lib/elliptic.min.js"></script>
  <script src="/static/cryptohash/lib/sha.js"></script>
  <script src="/static/cryptohash/lib/sha1.js"></script>
  <script src="/static/cryptohash/lib/sha3.js"></script>
  <script src="/static/cryptohash/lib/sha3-256.js"></script>
  <script src="/static/cryptohash/lib/sha256.js"></script>
  <script src="/static/cryptohash/lib/sha512.js"></script>
  <script src="/static/cryptohash/lib/sha_dev.js"></script>
  <script src="/static/protolib/protobuf.js"></script>
  <script src="/static/tronjslib/contract.js"></script>
  <script src="/static/tronjslib/tron.js"></script>
  <script src="/static/tronjslib/troninv.js"></script>
  <script src="/static/tronjslib/message.js"></script>
  <script src="/static/utils/code.js"></script>
  <script src="/static/cryptohash/crypto.js"></script>


  <script type="text/javascript">


    $(function () {

      //send account and address
      var priKeyBytes;
      var addressBytes;
      var address;
      var accountName;

      $("#accountName1").focus(function () {
        $("#accountName1").css("background-color", "#FFFFCC");

        priKeyBytes = genPriKey();

        addressBytes = getAddressFromPriKey(priKeyBytes);
        address = byteArray2hexStr(addressBytes)

        $("#addressName1").val(address);
      });
      $("#accountName1").blur(function () {
        $("#accountName1").css("background-color", "#D6D6FF");
        accountName = $("#accountName1").val();

        //TODO fix privateKey store
        $("#privateKey").val(priKeyBytes);

        var basePrivateKey = base64Encode(priKeyBytes);
        var pk = bytesToString(basePrivateKey);
        alert("Please save your private key  :    " + pk);

      });

      $("#register").on('click', function () {

        $.ajax({
          type: 'post',
          data: {address: address, name: accountName, accountType: 0},
          dataType: 'json',
          url: '/transactionForView',

          success: function (data) {

            var privateKeyBytes = $("#privateKey").val();
            var trxString = getSignedTransactionHexString(privateKeyBytes, data);
            $.ajax({
              type: 'post',
              dataType: 'json',
              data: {transactionData: trxString},
              url: '/transactionFromView',
              async: false,
              success: function (data) {
                alert("register is : " + data);

              }
            });
          }
        });

      });


      $("#block").on('click', function () {
        $.ajax({
          type: 'get',
          data:{num:0},
          dataType: 'json',
          url: '/getBlockByNumToView',
          success: function (base64Data) {

            var bytes = stringToBytes(base64Data);
            var bytesDecode = base64Decode(bytes);

            var block= proto.protocol.Block.deserializeBinary(bytesDecode);
            alert(block.getBlockHeader().getRawData().getNumber());


          }
        });

      });

   // var witness=  "{"+ "address" +":"+ "1111" +","+ "WitnessList"+":" + "["+"{"address +":"+ "qqq223"+","+ "voteCount"+":"+ "102"+","+ "url"+":"+"http://Olivier.org"+","+  "isJobs"+":"+"true"+"}"+"]"+"}"

      var witness={
        "ownerAddress": "1111",

        "list": [

          {

            "address": "qqq223",

            "amount": "102",

            "url": "http://Olivier.org",
            "isJobs": "true"
          }  ]
      }

       var v= JSON.stringify(witness);
      $("#witness").on('click', function () {
        $.ajax({
          type: 'post',
          data:{voteWitness:v},
          dataType: 'json',
          url: '/createVoteWitnessToView',
          success: function (base64Data) {


            alert(base64Data);


          }
        });

      });



    });


  </script>

</head>
<body>


<div class="uk-navbar uk-navbar-attached">
  <div class="uk-container uk-container-center">
    <a href="/" class="uk-navbar-brand"><i class="uk-icon-bitcoin"></i> Tron Block Chain</a>
    <ul class="uk-navbar-nav">
      <li><a target="_blank" href="https://tron.network/">Tron's official website</a></li>
      <li><a target="_blank" href="https://github.com/tronprotocol">Tron's github </a></li>
      <li><a target="_blank" href="/queryAccount">account List </a></li>
      <li><a target="_blank" href="/queryWitness">witness List </a></li>
      <li><a target="_blank" href="/createWitness">Create Witness </a></li>
      <li><a target="_blank" href="/createAssetIssue">AssetIssue </a></li>
      <li><a target="_blank" href="/sendCoin">SendCoin </a></li>
      <li><a target="_blank" href="/voteWitness">voteWitness </a></li>

      <li>
        <button id="block" type="button">blocks</button>
      </li>

      <li>
        <button id="witness" type="button">witness</button>
      </li>


    </ul>
  </div>
</div>

<div align="center">
  <h1>Query Balance</h1>
  <form action="#" th:action="@{/balance}" th:object="${accountVo}" method="post">
    <p>
      address: <input type="text" th:field="*{address}"/>
    </p>
    <p>
      <input type="submit" value="query"/>
      <input type="reset" value="Reset"/>
    </p>
  </form>
</div>

<!--<div align="center">
  <h1>Register Account</h1>
  <form action="#" th:action="@{/register}" th:object="${accountVo}" method="post">
    <p>
      name: <input id="accountName" type="text" th:field="*{name}"/>
      address: <input id="addressName" type="text" th:field="*{address}" readonly="readonly"/>
    </p>
    <p>
      <input id="query" type="submit" value="Commit"/>
      <input type="reset" value="Reset"/>
    </p>
  </form>
</div>-->


<div align="center">
  <h1>Register Account</h1>
  <form>
    <p>
      name: <input id="accountName1" type="text"/>
      address: <input id="addressName1" type="text" readonly="readonly"/>
    </p>
    <p>
      <input id="register" type="button" value="register"/>
      <input type="reset" value="Reset"/>
    </p>

    <p>
      <!--// TODO fix privateKey store-->
    <div id="privateKey" hidden="hidden"></div>
    </p>

  </form>
</div>


</body>
</html>